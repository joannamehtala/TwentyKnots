<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style type="text/css">
      html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
    </style>
    <link rel="stylesheet" href="kartta_style.css">
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC1pEM1hGTESl2YoesdrVnhuWfCdBsvJ78&sensor=false&libraries=places,drawing,geometry">
    </script>
    <script type="text/javascript">
            
    /********  GOOGLE MAPS SETIT ALKAA ********/    
     
    /* meidän pääkartta */    
    var map;    
    
    function initialize() {
        var mapOptions = {
          center: { lat: 60.13176, lng: 24.793814},
          zoom: 12
        
        };
        map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
        
        suvisaaristo.markkerit[0].setMap(map);

        google.maps.event.addListener(suvisaaristo.markkerit[0], 'click', function() {
                suvisaaristo.piirraReitti(map);
                suvisaaristo.avaaInfoWindow(map, suvisaaristo.markkerit[0]);
                suvisaaristo.markkerit[1].setMap(map);
                suvisaaristo.markkerit[2].setMap(map);
        });

        google.maps.event.addListener(suvisaaristo.markkerit[1], 'click', function() {
                console.log("Menee tanne");
                kuva1.avaaKuvaWindow(map, suvisaaristo.markkerit[1]);
        });
    
    }
        
    
        
    google.maps.event.addDomListener(window, 'load', initialize);
        
        
        
        
        
        
    /********************************************************/
    /****************** luodaan retki olio ******************/
    /********************************************************/
        
    function retki(nimi, koordinaatit, tiedot, zoomLevel){
        
        /* attribuutit */
        this.nimi = nimi;
        this.koordinaatit = koordinaatit;
        this.tiedot = tiedot;
        this.zoomLevel = zoomLevel;
        this.markkerit = [];
        
        
        /* funktioita */
        this.muutaZoom = function(kartta) {
          kartta.setZoom(this.zoomLevel);
        }
        
    
        this.piirraReitti = function(kartta) {
           
            var x = 0;
            var departure = suvisaaristo.koordinaatit[x];
            var arrival = suvisaaristo.koordinaatit[x+1];
            var reitti = new google.maps.Polyline({
                path: [departure, departure],
                strokeColor: "#FF0000",
                strokeOpacity: 0.7,
                strokeWeight: 2,
                geodesic: true, //set to false if you want straight line instead of arc
                map: kartta,
            });
               
            var step = 0;
            var numSteps = 100; //Change this to set animation resolution
            var timePerStep = 2; //Change this to alter animation speed
            var interval;
            var path = [];
            var ensimmainenKerta = true;
            
            function alustaAnimaatio(){
                
                departure = suvisaaristo.koordinaatit[x];
                arrival = suvisaaristo.koordinaatit[x+1];
                step = 0;
                if(x < suvisaaristo.koordinaatit.length-1){
                    interval = setInterval(animoiReitti, timePerStep);
                }
            }
                
            function animoiReitti(){
                   
                   step += 1;
                   if (step > numSteps) {  
                       clearInterval(interval);
                       x++;
                       alustaAnimaatio();
                   } else { 
                       var are_we_there_yet = google.maps.geometry.spherical.interpolate(departure,arrival,step/numSteps);
                       if(ensimmainenKerta){
                         path.push(are_we_there_yet);
                         path.push(departure);
                         ensimmainenKerta = false;
                       } else {
                         path.push(departure);
                         path[path.length-1] = are_we_there_yet;
                       }
                       reitti.setPath(path);       
                   }       
            }
            alustaAnimaatio();
            this.muutaZoom(kartta);
        }
    

        
        this.avaaInfoWindow = function(map, marker){
            var info = tiedot.annaHTMLMuodossa(); 
            var infowindow = new google.maps.InfoWindow({
                  maxWidth: 400,
                  content: info
            });

            infowindow.open(map, marker);
        }
    }

        

        
 /********************************************************/
 /****************** luodaan tiedot olio *****************/
 /********************************************************/        
        
        
    function tiedot(nimi, kuvaus, ajankohta, kesto, hinta){
        this.nimi = nimi;
        this.kuvaus = kuvaus;
        this.ajankohta = ajankohta;
        this.kesto = kesto;
        this.hinta = hinta;

        this.annaHTMLMuodossa = function(){
            var htmlMuodossa = '<div id="content" class="infobox">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<h1 id="firstHeading" class="firstHeading">'+this.nimi+'</h1>'+
            '<div id="bodyContent">'+
            '<p>'+this.kuvaus+'</p>'+
            '</div>'+
            '</div>';

            return htmlMuodossa;
        }
    }

 /********************************************************/
 /****************** luodaan kuva olio *******************/
 /********************************************************/            
   
        
    function kuva(kuvatiedosto, markkeri){
        this.kuvatiedosto = kuvatiedosto;
        this.markkeri = markkeri;

        this.avaaKuvaWindow = function(map, markkeri){
            var kuvaWindow = new google.maps.InfoWindow({
                  content: '<div id="content" class="infobox">'+
                            '<div id="siteNotice">'+
                            '</div>'+
                            '<div id="bodyContent">'+
                            '<img src="'+this.kuvatiedosto+'" width="500">'+
                            '</div>'+
                            '</div>'
                            });

            kuvaWindow.open(map, markkeri);
        }
    }

        
    
 /********************************************************/
 /****************** luodaan retkiä **********************/
 /********************************************************/    
        
    /* luodaan retkiä */ 
    var nimi = "suvisaaristo";
    var kuvaus = "Kevään ensimmäisellä retkellä kierrämme kauniin Suinon saaren. Monipuolisen melontareitin varrella pääsee ihastelemaan saaren kaunista luontoa, upeita näkymiä aavalle merelle sekä suloisia saaristohuviloita. Pysähdymme retken aikana luodolle nauttimaan kuumaa juotavaa ja retkieväitä. Jokainen osallistuja saa paikanpäältä lämpimän märkäpuvun ja tossut.";
    var ajankohta = "huhtikuu";
    var kesto = "2 tuntia";
    var hinta = "50 €"; 
    var tiedotSuvisaaristo = new tiedot(nimi, kuvaus, ajankohta, kesto, hinta);

    var suvisaaristo = new retki("suvisaaristo", [
      new google.maps.LatLng(60.13176, 24.793814),
      new google.maps.LatLng(60.135664, 24.814234),
      new google.maps.LatLng(60.124721, 24.824534),
      new google.maps.LatLng(60.117024, 24.797068),
      new google.maps.LatLng(60.128996, 24.791232),
      new google.maps.LatLng(60.13176, 24.793814)
      ], tiedotSuvisaaristo, 14);
        
    var image = new google.maps.MarkerImage("images/karttaicons/kamera.png", null, null, null, new      google.maps.Size(40, 40));
    var image2 = new google.maps.MarkerImage("images/karttaicons/markkeri.png", null, null, null, new      google.maps.Size(54, 84));
    
    
    var aloitus = new google.maps.Marker({
                  position: { lat: 60.13176, lng: 24.793814},
                  map: map,
                  icon: image2
    });    
        
        
    /* luodaan retken markkereita */    
    var kuvia1 = new google.maps.Marker({
                  position: { lat: 60.135023, lng: 24.816037 },
                  map: map,
                  icon: image
    });

    var kuvia2 = new google.maps.Marker({
                  position: { lat: 60.124721, lng: 24.824534 },
                  map: map,
                  icon: image
    })


    
    /* lisätäänmarkkerit retken markkerit listaan */
    suvisaaristo.markkerit.push(aloitus);
    suvisaaristo.markkerit.push(kuvia1);
    suvisaaristo.markkerit.push(kuvia2);

    var kuva1 = new kuva("images/supyoga.jpg", suvisaaristo.markkerit[1]);
    

    </script>
  </head>
  <body>
<div id="map-canvas"></div>
  </body>
</html>